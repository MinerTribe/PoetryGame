# 飛花令

> 春城無處不飛花。寒食東風御柳斜。

<details>
    <summary>繁體中文規則說明</summary>
    飛花令是文人雅集所行酒令。本插件飛花令規則與詩詞大會之飛花令規則類似，但略有不同。
    輸入指令 “/flutteringblossoms join” 加入游戲。
    首先，每位玩家各說一個字，作爲行令字僃選。之後將人氣最高的字作爲行令字。
    每一位玩家按照次序，説出一句含有這個行令字的詩句。行令字的位置不論。祇要含有行令字即視作有效。但是不可以重復說他人已經説過的詩句。
    如行令字為“花”，有三位玩家參與。甲說“春江花朝秋月夜”，乙說“年年歲歲花相似”，丙說“人面桃花相映紅”。三位玩家全部説完則為一輪，此時又輪到甲。甲說“花間一壺酒”。乙丙在規定時間内不能對令，淘汰。
    當然，考慮到打字常會出錯，只要在規定時間内就可以修改自己的錯誤答案。
    每次對令都必須在消息的最前方加上“行令”二字。如“行令 春城無處不飛花”。
</details>

<details>
    <summary>简体中文规则说明</summary>
    飞花令是文人雅集所行酒令。本插件飞花令规则与诗词大会之飞花令规则类似，但略有不同。
    输入指令 “/flutteringblossoms join” 加入游戏。
    首先，每位玩家各说一个字，作为行令字备选。之后将人气最高的字作为行令字。
    每一位玩家按照次序，说出一句含有行令字的诗句。行令字的位置不论。只要含有这个字即视作有效。
    如行令字为“花”，有三位玩家参与。甲说“春江花朝秋月夜”，乙说“年年岁岁花相似”，丙说“人面桃花相映紅”。三位玩家全部说完则为一轮，此時又轮到甲。甲说“花间一壶酒”。乙丙在规定时间内不能对令，淘汰。
    当然，考虑到打字常会出错，只要在规定时间内就可以修改自己的错误答案。
    每次对令都必须在消息的最前方加上“行令”二字。如“行令 春城无处不飞花”。
</details>

繁體、简体行令本插件都支持。客戶端語言為繁體則收到繁體中文消息，客户端语言为简体则收到简体中文消息。内部將完成一定的繁簡轉換，以便使用繁體和简体的玩家同臺競技。内部将完成一定的繁简转换，以便使用繁体和简体的玩家同台竞技。

可以利用 `/flutteringblossoms tip` 来得到提示。你可以編寫事件監聽器，監聽 `AsyncPlayerTipEvent` 来控制提示功能，默認不限制。

本插件附帶了一些其他游戲，（正在更新中），或單人或多人，見下方：

<details>
    <summary>诗词辨认</summary>
    输入指令“/poetryidentification join” 加入游戏。
    这之后，将会显示一组乱序的字，玩家需要排列出一句正确的诗句。五言诗句有两个字作为干扰项（七选五），七言诗句有五个字作为干扰项（十二选七）。所有诗句全部来自《唐诗三百首》。
    每次答题都必须在消息前加上“辨诗”二字，繁简均可。
    最快排列正确者答对这一题。答对题数最多者获胜。
    如有一组字：
    “春，城，无，处，不，飞，花，寒，食，东，风，御”，则玩家输入“辨诗 春城无处不飞花”即为正确。
</details>


本插件主要通過 Bukkit 自帶的 Event Bus 來提供 API 。如果你有意開發附屬，歡迎聯係我以添加或更改事件。事件全都位於 `api/event` 包下。



注意！本插件采用 [Chinese-Poetry](www.github.com/Chinese-Poetry/Chinese-Poetry) 的唐、宋二代古詩，未采用宋詞。不能使用宋詞行令。

注意！全部 300000 首左右古詩大小占 90+MB，不便插件使用，因此按自帶的 [Rank](https://github.com/chinese-poetry/chinese-poetry/tree/master/rank) 排序，挑出 10000 首知名度排名最靠前的古詩，占 3 MB 左右，供匹配。排序可靠性未必很高，但自帶的排序使用方便。有少部分名句未被收錄，目前尚沒有好的解決方法。（可能需要 Web API ）

注意！如果您想要修改古詩文本的部分，需要首先自行拉取 Chinese-Poetry （Unzipped 300+MB），文件夹重命名 `chinese-poetry-master` ，放在根目錄。再修改 `dev` 包下的一些常量，重新生成 `json` 文件。不涉及到古詩文本的修改不需要如此麻煩，因所有文本已生成好、置于 `src/main/resources` 下。

